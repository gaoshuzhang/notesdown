# 数值模拟 {#simulations}

响应变量为二项分布，模拟数据，相应的空间广义线性混合效应模型分别是\@ref(eq:SGPSM1)和 \@ref(eq:SGPSM2)。RandomFields 是模拟多元随机场的 R 包 [@RandomFields2015]， geoR 包[@R-geoR] 的 grf 函数只适合模拟少量数据点（$n < 500$）， MASS 包的 glmmPQL 函数采用惩罚拟似然求解带空间效应的广义线性混合效应模型[@MASS2002]。 方程 \@ref(eq:SGPSM1) 在有些文献中也称为标准地质统计流行抽样模型 (Standard Geostatistical Prevalence Sampling Model)[@Diggle2007]。

\begin{gather}
\log\big\{\frac{p(x_i)}{1-p(x_i)}\big\} = d(x_i)'\beta + S(x_i) + Z_i (\#eq:SGPSM1)\\
\log[\lambda(x_i)] = d(x_i)'\beta + S(x_i) + Z_i (\#eq:SGPSM2)
\end{gather}

产生模拟数据的模型参数有$n=1600,\sigma^2=1,\phi=25,\tau^2=1,\kappa=1,\beta_0=1.2$，图 \@ref(fig:reg-gp) 表示规则网格上的采样，图\@ref(fig:irreg-gp) 表示随机采样

```{r reg-gp,fig.cap="模拟高斯过程：核函数分别为指数族（左图），梅隆族（右图）"}
knitr::include_graphics(path = "figures/reg-gp.pdf")
```
```{r irreg-gp,fig.cap="模拟高斯过程：核函数分别为指数族（左图），梅隆族（右图）"}
knitr::include_graphics(path = "figures/irreg-gp.pdf")
```
```{r mesh-spde,fig.cap="基于INLA的三角网格划分"}
knitr::include_graphics(path = "figures/mesh-spde.pdf")
```

此处模拟数据集来自零均值高斯过程规则单元网格格上 $30 \times 30$ 参数 $\sigma^2 = 1, \phi = 0.15, \kappa =  2$，块金效应 (nugget effect) $\tau^2 = 0$的指数族，每个格点上重复实验10次，模拟响应变量二项分布的概率值。REML 方法图\@ref(fig:spamm-sim)，INLA方法图 \@ref(fig:tri-mesh) ，低秩近似和 MCML 方法图 \@ref(fig:low-rank) 

```{r low-rank, fig.cap = "低秩近似方法与精确蒙特卡罗最大似然方法"}
knitr::include_graphics(path = "figures/simulation.pdf")
```
```{r inla-simulation, fig.cap = "INLA方法"}
knitr::include_graphics(path = "figures/INLA-simulation.pdf")
```
```{r spamm-sim,fig.cap="规则网格上预测结果（REML方法）"}
knitr::include_graphics(path = "figures/spaMM-simulation.pdf")
```
