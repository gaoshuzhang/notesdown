# 数值模拟 {#simulations}

模拟的空间广义线性混合效应模型分别是\@ref(eq:SGPSM1)和 \@ref(eq:SGPSM2)。RandomFields 可以模拟多元随机场 [@RandomFields2015]， geoR 包[@R-geoR] 的 `grf` 函数只适合模拟少量样本点（$n < 500$）， MASS 包的 `glmmPQL` 函数采用惩罚拟似然求解模型[@MASS2002]。模型参数设置为 $n=1600,\sigma^2=1,\phi=25,\tau^2=1,\kappa=1,\beta_0=1.2$，图 \@ref(fig:reg-gp) 模拟规则网格上的采样，图\@ref(fig:irreg-gp) 模拟随机采样，图 \@ref(fig:mesh-spde) 基于INLA方法模拟三角网格。每个格点上重复实验10次，得到响应变量二项分布的概率值。REML 方法图\@ref(fig:spamm-sim)，INLA 方法图 \@ref(fig:inla-simulation) ，低秩近似和 MCML 方法图 \@ref(fig:low-rank)\begin{gather}
\log\big\{\frac{p(x_i)}{1-p(x_i)}\big\} = d(x_i)'\beta + S(x_i) + Z_i (\#eq:SGPSM1)\\
\log[\lambda(x_i)] = d(x_i)'\beta + S(x_i) + Z_i (\#eq:SGPSM2)
\end{gather}

```{r reg-gp,fig.cap="模拟高斯过程：核函数分别为指数族（左图），梅隆族（右图）"}
knitr::include_graphics(path = "figures/reg-gp.pdf")
```
```{r irreg-gp,fig.cap="模拟高斯过程：核函数分别为指数族（左图），梅隆族（右图）", out.width="90%"}
knitr::include_graphics(path = "figures/irreg-gp.pdf")
```
```{r mesh-spde,fig.cap="基于INLA的三角网格划分", out.width="70%"}
knitr::include_graphics(path = "figures/mesh-spde.pdf")
```
```{r low-rank, fig.cap = "低秩近似方法与精确蒙特卡罗最大似然方法"}
knitr::include_graphics(path = "figures/simulation.pdf")
```
```{r inla-simulation, fig.cap = "INLA方法"}
knitr::include_graphics(path = "figures/INLA-simulation.pdf")
```
```{r spamm-sim,fig.cap="规则网格上预测结果（REML方法）"}
knitr::include_graphics(path = "figures/spaMM-simulation.pdf")
```
